language: node_js
node_js:
  - 12.13.0
services:
  - postgresql
  - docker
before_script:
  - psql -c 'create database simple_order_test;' -U postgres
script:
  - yarn test
  - yarn coveralls

deploy:
  - provider: script
    script: bash ./publish-docker.sh master
    on:
      branch: master
  - provider: script
    script: bash ./publish-docker.sh develop
    on:
      branch: develop
  - provider: script
    script: bash ./publish-docker.sh tag
    on:
      tags: true
